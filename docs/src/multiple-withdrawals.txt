/**
 * Withdraws ether with signed payment message.
 *
 * @param authorizedAmount    amount of the payment.
 * @param signature           ECDSA signature of the payment message
 */
function withdraw(uint256 authorizedAmount, bytes memory signature) public {
  require(msg.sender == receiver, "Only the receiver can withdraw ether.");
  require(verifyPayment_(authorizedAmount, signature),
    "Signed payment message is invalid.");
  require(authorizedAmount > withdrawnAmount,
    "Authorized amount must be greater than amount already withdrawn.");

  // Actual amount will be withdrawn in the following transaction.
  uint256 amount = authorizedAmount - withdrawnAmount;
  withdrawnAmount += amount;
  (bool success,) = receiver.call{value : amount}("");
  require(success, "Transaction failed.");
}